# RIP 
ディスタンスベクタ型ルーティングプロトコルの1つ。

|            項目            |                              特徴                              |
|:--------------------------:|:--------------------------------------------------------------:|
|ルーティングプロトコルタイプ|    距離(distance)と方向(vector)を基準に最適ルートを決定する    |
|         メトリック         |ポップ数(経由するルータの数)。最大ポップは15(それ以上は到達不可)|
|ルーティングプロトコルタイマ|Update(30sec), Invalid(180sec), Hold down(180sec), Flush(240sec)|
|  ルーティングのアプデ方法  |         定期的(30秒)にテーブル全体を隣接ルータに通知           |
|     ロードバランシング     |同じメトリック値の最適経路複数ある時、最大16までの経路を保持可能|
|  クラスフル or クラスレス  |  RIPv1はクラスフルルーティング、RIPv2はクラスレスルーティング  |


* RIPv1とRIPv2の違い

|         項目         |               RIPv1             |          RIPv2          |
|:--------------------:|:-------------------------------:|:-----------------------:|
|   アプデの通知方法   |ブロードキャスト(255.255.255.255)|マルチキャスト(234.0.0.9)| 
|クラスフルorクラスレス|            クラスフル           |        クラスレス       |
|       経路集約       |        自動経路集約のみ         |自動と手動どちらでも可能 |
|    VSLMのサポート    |           サポートなし          |       サポートあり      |
|         認証         |           サポートなし          |       サポートあり      |

## RIPの起動設定
### RIP version 1の設定
グローバルコンフィグレーションモードで以下のコマンドを入力する。  
`(config) # router rip`  
`(config-router) #`

RIPを有効にしたいI/FをIPアドレスで指定する。  
指定する際は、そのI/FのIPアドレスをクラスフルアドレスとして指定する。
`(config-router) # network 192.168.0.0`  
`(config-router) # network 192.168.1.0`

### RIP version 2の設定
router ripコマンドでルータコンフィグレーションモードに移行してから以下コマンドを入力する。
`(config-router) # version 2`

## I/FごとのRIPバージョンの設定
RIPのバージョンは隣接ルータと一致させる必要がある。異なる場合は以下コマンドで変更できる。  
```sh
(config) # interface [interface_name] 
(config-if) # ip rip send version 1 
(config-if) # ip rip receive version 1
```

***

# EIGRP
Cisco独自のルーティングプロトコル。ディスタンスベクタ型とリンクステート型両方の利点を持つ。  
>*拡張ディスタンスベクタ型*または*ハイブリッド型*ルーティングプロトコルともいわれている。  
    Cisco製品だけで構築するNWでは、EIGRPが最適なダイナミックルーティングプロトコル

## EIGRPの3つのテーブル

|   EIGRPのテーブル  |                                  説明                                 |
|:------------------:|:---------------------------------------------------------------------:|
|  ネイバーテーブル  |Helloパケットによりネイバー関係が確立されたEIGRPルータのネイバーリスト |
|  トポロジテーブル  |        学習した宛先NWへの全てのルートを保持するデータベース           |
|ルーティングテーブル|トポロジテーブルから得られた最適ルート。受信したパケット転送の際に使用 |

動作はリンクステート型ルーティングプロトコルと似ている。

## 5種類のパケット
EIGRPでは、以下5つ種類のパケットを隣接ルータとやり取りすることにより、動的にネイバー関係を確立したうえで、  
ネイバーテーブル、トポロジテーブル、ルーティングテーブルを細心に保つことができる。

|パケット名|                                        説明                                       |
|:--------:|:---------------------------------------------------------------------------------:|
|  Hello   |     ネイバー検出のためのパケット。確立後はキープアライブとしても使用される        |
|  Update  |ルーティングアップデートを送信する為のパケット。EIGRP開始時の同期では*ユニキャスト*|
|  Query   |             ルート情報をネイバールータに問い合わせる際に使用するパケット          |
|  Reply   |     Queryの応答パケットとしてネイバールータにユニキャストで送信されるパケット     |
|   Ack    |  Update/Query/Replyパケットに対する確認応答としてユニキャストで送信されるパケット |

### EIGRPの仕組み
EIGRPのネイバー確立はOSPFのネイバー確立と同様にHelloパケットのやり取りで実現する。  

自身のルート情報をUpdateパケットにより送信した後、隣接ルータからAckパケットを受信することで、  
再び同じルート情報を送信しないようにする。トポロジテーブルに格納されたルート情報は、  
EIGRPのDUALアルゴリズムによって、最適ルート(パス)だけがルーティングテーブルへ自動的に格納される。  

宛先NWへの最適ルート(サクセサ)がダウンして、その宛先NWへのバックアップルートがない場合、  
EIGRPルータはネイバールータに対しQueryパケットを送信してルート情報を知らないか確認する。  
ネイバールータは、このQueryパケットを受信するとそのNWはダウンしたと知る。

## 複合メトリック
RIPv1/RIPv2のメトリックは、***ポップ数***、OSPFは***コスト***、EIGRPは***複合メトリック***。  
複合メトリックとは、***帯域幅(bandwidth)、遅延(delay)、信頼性(reliability)、負荷(load)、MTU***の5つのこと。 

|メトリック|                       説明                       |
|:--------:|:------------------------------------------------:|
|  帯域幅  | ローカルルータから宛先NWに至るまでの*最小帯域幅* |
|   遅延   |ローカルルータから宛先NWに至るまでの*遅延の合計値*|

|メトリック|                       公式                       |
|:--------:|:------------------------------------------------:|
|  帯域幅  |         10000 / 最小帯域幅(Mbps) * 256           |
|   遅延   |        遅延(10マイクロ秒)の合計値 * 256          |

|メトリック|                        例：100MbpsのI/Fの場合                          |
|:--------:|:----------------------------------------------------------------------:|
|  帯域幅  |show int では「BW 100,000Kbps」と表示されるので、単位をMbpsにして「100」|
|   遅延   |   show int では「DLY 100μsec」と表示されるので、100 / 10 にして「10」  |

## サクセサとフィージブルサクセサ
EIGRPでは高速収束の実現のために、***DUAL (Diffusing Update Algorithm)***というアルゴリズムを使用する。  
>DUAL  
    受信したUpdateパケット(経路情報)の複合メトリックに基づいて計算し、ある宛先への最適な経路を計算する。  
    その結果、最適ルートであるプライマリルート(=サクセサ)をルーティングテーブルに保存して、  
    ループフリーであるバックアップルート(=フィージブルサクセサ)をトポロジテーブルへ保存する。