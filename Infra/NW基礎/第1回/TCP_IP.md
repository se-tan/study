# TCP/IP(Transmission Control Protocol)
## 1. 階層モデル
|          階層           |     OSI参照モデル階層                            |
|:-----------------------:|:-------------------------------------------------|
|   アプリケーション層    |アプリケーション、プレゼンテーション、セッション層|
|    トランスポート層     |トランスポート層                                  |
|    インターネット層     |ネットワーク層                                    |
|    ネットワークI/F層    |データリンク層、物理層                            |

### アプリケーション層
アプリケーションごとの固有規定。HTTP, FTP, SMTP, SSHなどのプロトコルにより、  
通信アプリケーションの機能が実現される。

### トランスポート層
ノード間のデータ転送の信頼性を確保する規定。TCPまたはUDPを使用する。

### インターネット層
NW間のエンドツーエンドの通信のための規定。IPが代表的なプロトコル。  
IPにより、NW上のノードに対し自分の位置情報となる論理アドレスを割り当てられる。

### ネットワークI/F層
直接的に接続されたノード間の通信のための規定。LANはイーサネット、WANはPPP。  
イーサネットではセグメント上のノードに対して、MACアドレスを割り当てることができる。

## 2. IP
OSI参照モデル：ネットワーク層、TCP/IP階層モデル：インターネット層で動作するプロトコル。  
IPは論理アドレス(IPアドレス)を書くノードに割り当てることで、各ノードを識別できる。  
IPアドレスの宛先情報はIPヘッダに含まれている。

### 2-1. IPヘッダのフォーマット
IPヘッダは*20バイト*。「データ」はIPヘッダになく、IPペイロードにある。

### 2-2. IPプロトコルの特徴
1. コネクションレス型通信  
事前にコンピュータ間でコネクションを確立しないでデータ転送を始める通信。  
2. ベストエフォート型通信  
必ずしも十分な品質は保証しない通信。
3. 階層型アドレッシング  
IPアドレスは、コンピュータが所属しているグループ(NW部)と、そのネットワークに接続されているコンピュータを識別する番号(ホスト部)の2階層で構成される。

## 3. ARP (Address Resolution Protocol)
IPアドレスからEthernetのMACアドレスの情報を得られるプロトコル。  
下位レイヤでMACアドレス情報をヘッダに付加しなければならないので、ARPで得る必要がある。

### 3-1. 仕組み
*ARPリクエスト*と*ARPリプライ*の2種類のパケットがある。  
1. 同じセグメントすべての端末にARPリクエストをブロードキャストする。
2. 受信したすべてのノードのうち、送信先に指定したノードが送信元へARPリプライを返す。  

異なるネットワークと通信する場合は、自身のデフォルトゲートウェイにARPリクエストを送信して、MACアドレスを取得する。  

## 4. RARP (Reverse Address Resolution Protocol)
EthernetのMACアドレスからIPアドレスの情報を得ることができるプロトコル。

## 5. GARP (Gratuitous ARP)
1. 自分自身に設定する*IPアドレスが重複していないかどうかを検知*
2. 同一セグメントのNW機器上の*ARPキャッシュを更新*させる  

自分自身に設定するIPアドレスに対するARPのこと。

### 5-1. GARPの役割其の壱
自分自身にIPアドレスがアサインされるときに他のホストが同じIPアドレスを使用していないかどうか確認する。 
→ARPリプライが返ってくるなら重複を検知できる。

### 5-2. GARPの役割其の弐
同じセグメントのNW機器上のARPキャッシュを更新することで、  
VRRPやHSRPなどで切り替わりが発生した機器とすぐに通信できるようにするためにも使用される。


### 5-3. ARPキャッシュとARPテーブル
ARPリクエストとARPリプライによってARP情報がやり取りされると、*ARPキャッシュ*として一定時間情報が残る。  
その場合は、ARPのやり取り不要でLANでの通信ができる。