# ネットワークセキュリティ
デジタルの情報資産を保護するための防衛策、コンピュータネットワークにおける安全運用を維持するための防衛策
  
## オープンネットワーク
直接的または間接的にインターネットや外部と接続している形態。

## セキュリティ対策
### 多要素認証 (Multi-Factor Authentication)
アクセス権限を得るために必要な本人確認のために、**2つ以上の要素で認証する方式**。  
|   Factor  |         Description           |                HowTo                |
|:---------:|:-----------------------------:|:-----------------------------------:|
| 知識要素  |    認証の為に知っている情報   |   ID/パスワード,PIN番号,秘密の質問  |
| 所持要素  |    認証の為に持っている情報   |ワンタイムパスワード,ICカード,SMS認証|
| 生体要素  |  認証の為の自身の身体的な情報 |  指紋認証,顔認証,網膜認証,静脈認証  |

>二段階認証：1種類の要素の2つの方法を使用している場合の認証方式  
ID/パスワードを入力して認証した後、「秘密の質問」に答えて認証できた場合(知識要素の2つの認証方法を使用)

## クローズドネットワーク
物理的にも、論理的にも、完全に外部と接続をしていない形態。  
「*内部のネットワークには必ず不正利用者がいる*」前提で考えることが重要。

***

## 攻撃者
NEシステムにおける攻撃者は**ハッカー**と呼ばれるが正確には**クラッカー**。

|   Word     |                                Description                                   |
|:----------:|:----------------------------------------------------------------------------:|
| ハッキング |コンピュータや通信システムの動作解析、プログラムの改良をすること。技術者を指す|
|  ハッカー  |                           ハッキングを行う技術者のこと                       |
|クラッキング|他人のコンピュータのデータやプログラムの盗み見、改ざん、破壊などを行うこと    |
| クラッカー |クラッキングを行う技術者のこと                                                |
|  Firewall  |外部NWから内部NW上のコンピュータに対して不正アクセスを防止するシステム        |
|     IDS    |侵入***検知***システム。不正なアクセスや悪意あるトラフィックを検知して通知する|
|     IPS    |侵入***防止***システム。不正なアクセスや悪意あるトラフィックを検知、通知、防御する|

## 攻撃手法
調査    →   アクセス    →   攻撃  
の3ステップを踏んで攻撃してくる。アクセスは**アクセス攻撃**、攻撃は**サービス不能攻撃**ともいう。

### 調査
標的NWにおいてどのIPアドレスが有効なのかを、**pingスイープ**する。
>pingスイープ：IPアドレスを自動的に増加させるpingツールのこと

pingスイープによって判明したIPアドレスのホストへ**ポートスキャン**を行うことで現在有効であるサービスポートを特定する。  
これにより標的サーバで稼働しているOSのバージョン、アプリケーションの種別、アプリケーションのバージョンがわかる。

### アクセス
権限のない侵入者がIDとパスワードを不正に取得して、さーばへのアクセス権を獲得する能力のこと。  
不正アクセスをするための悪用ツールの実行も指す。
* 辞書攻撃  
    辞書にある単語をパスワードとして延々と入力して解読する手法

* 総当たり攻撃  
    考えられる可能な組み合わせをパスワードとして試す手法

これらの手法でIDとパスワード情報が得られたら、サーバに不正アクセスし、サーバに目立たないよう***バックドア***を設ける。  
>一度侵入したシステムに次回も容易にアクセスできるようにするための侵入経路のこと。  
このバックドアの生成能力とログの消去能力でクラッカーのレベルを判断可能。

### 攻撃
サービス不能攻撃のこと。サービス不能とは、具体的にはサーバ上のディスクスペース、帯域、バッファ、  
CPU、メモリへ高い負荷をかけて、リソースを使い果たして正規ユーザに対するサービスを妨害する行為のこと。  

* DoS攻撃  
    NW機器、サーバへのシステム攻撃を行い、正規ユーザへのサービス提供を不能にすること。  
    例：***SYNフラッド攻撃***,***ICMPフラッド攻撃***,***smurf攻撃***など

* DDoS攻撃  
    DoSより大規模で実行される攻撃。複数NWに分散する大量のコンピュータから一斉に攻撃を仕掛ける攻撃手法。

* ウイルス  
    コンピュータに不正侵入して障害を引き起こす不正プログラム。  
    自身で複製していくタイプは**ワーム**と呼ばれる。

* トロイの木馬  
    正体を偽りコンピュータへ不正侵入してコンピュータ自身のデータ破壊や、他のコンピュータなどの破壊活動を行う不正なプログラム。  
    一見普通の実行形式のプログラムのように見せかけているため、見分けがつかない

***

## ファイアウォール
インターネットなどの外部NWから、社内NWなどの内部NWへの不正なアクセスを防止するシステム。  
外部から発生するトラフィックは拒否し、内部から外部へのトラフィックの***戻りのトラフィックは許可***する。
    
しかし、パケットが悪意あるトラフィックかどうかは確認できないため、IDSやIPS導入の必要性がある。

### IDS (Intrusion Detection System)  
侵入検知システム。不正アクセスなどの悪意あるトラフィックを検知して通知する。  
Firewall前におかれたIDSは、NW上を流れるトラフィックを監視していて、不正アクセスと思われるパケットを検知すると、システム管理者に通知する。  
不正アクセスのパケットなのかの判断は、**シグネチャ**と呼ばれる攻撃パターンのDBを使用する。  
この通知を受けて、管理者はFirewallのフィルタリング強化などをして攻撃に備える。

### IPS (Intrusion Prevention System)  
侵入防止ステム。悪意あるトラフィックの検知だけでなく、シグネチャを参照し不正アクセスに該当するパケットを破棄したり、  
セッションを切断して即座に防御する。

## ファイアウォール導入時のネットワーク構成
企業ネットワークにファイルとを導入する場合は、最低でも3つに分離する。
|     NW      |               Meaning               | 
|:-----------:|:-----------------------------------:|
|    内部NW   |社内NWなどの内部NW。Trustネットワーク|
|    外部NW   |インターネットなど外部NW。Untrustネットワーク|
|     DMZ     |内部、外部NWの両方から分離されたNW|

***

## ファイアウォールの基本機能

### ステートフルインスペクション
ファイアウォールを通過するパケットの中身を見て、動的にポートを開放したり、閉鎖したりする機能のこと。  
LAN側から送信したデータをセッションログとして一時的に保存しておき、WAN(インターネット)側から到着した  
パケットがセッションログと整合性が合うかどうかを確認して、*整合性が合うときは開放*、矛盾する場合は閉鎖する。

### ステートフルフェールオーバー
ファイアウォールで保持している通信セッションの情報を、冗長化したバックアップのファイアウォールに引き継げる機能のこと。  
主系のファイアウォールに障害が発生しても、副系のファイアウォールで通信を継続することができる。  

実装には、冗長化を構成する2台のファイアウォール同士を、**フェールオーバーケーブル**で接続する。  
この接続したファイアウォール間のリンクは**フェールオーバーリンク**といい、このリンクで正常性を確認する。

***

## WAF (Web Application Firewall)
従来のファイアウォールやIDS/IPSでは防げない不正な攻撃から**Webアプリケーションを防御するファイアウォール**。  
一般的にはポート番号80番、443番のトラフィックを双方向で監視して、悪意あるユーザからWebアプリケーションとそのデータを守る製品のこと。  

ファイアウォールがIPとポート番号を防御、IPSがプラットフォームレイヤを防御、WAFはWebアプリケーションレイヤを防御する。

### Firewall, IPS, WAFの違い
|  Product  |                       Difference                         |
|:---------:|:--------------------------------------------------------:|
| Firewall  |通信における送信元情報と送信先情報を検査して防御を行う|
|    IPS    |多様なアプリケーション(プロトコル)へのリクエストに対して、シグネチャに基づいて防御する|
|    WAF    |Webアプリケーションへのリクエストに対して、シグネチャやホワイトリストに基づいて防御する|

### SQLインジェクション
入力フォームに不正なSQL文を挿入することで、不正にユーザ情報を入手したりDBを改ざんしたりできる。

### OSコマンドインジェクション
外部からサーバ上の任意のOSコマンドを実行することで、サーバ内のデータ破壊、重要ファイルの流出、  
攻撃者によるサーバの乗っ取りを行う攻撃のこと。  
>パラメータを介してコンピュータに命令を送り込む。

### クロスサイトスクリプティング (XSS)
悪意あるスクリプトをXSSの脆弱性のあるWebサイトに仕掛けることで、不正なスクリプトをユーザに実行させる攻撃
  
直接的な被害はユーザ側だが、Webサイトは信頼性を失いユーザの個人情報が流出する可能性があるので、同様の害を被る。

***

## UTM (Unified Treat Management：統合脅威管理)
複数のセキュリティ機能を1つの製品に統合し、集中的にセキュリティ対策する手法。  
IPS、アンチウイルス、アンチスパム、Webフィルタリング、アプリケーション制御、脆弱性管理、IPレピュテーションなどを有する。  
* メリット  
    セキュリティ対策コストを抑えられる点と運用管理がしやすい点
* デメリット  
    負荷のかかるセキュリティ機能を有効化した場合、通信速度が大幅に低下する