# Storage Services

## ■ Amazon S3

同一リージョン内の 3 箇所の AZ へ自動的に複製される。

<br>

## 1. バージョニング機能

## 2. クロスリージョンレプリケーション

有効化することで、**別のリージョンの S3 バケット**に複製できる。別の AWS アカウントも指定可能。

<br>

## 3. セキュリティ対策

- IAM ポリシーによるアクセス制御

- バケットポリシーによるアクセス制御

  JSON コードを記載してバケット全体の制御を行なう機能。

- ACL によるアクセス制御

  AWS アカウントレベルの制御を行なう。

- ブロックパブリックアクセスによるアクセス制御

  バケットポリシーや ACL の設定に対し、一括で制限を設けることができる。

<br>

## 4. コスト最適化

- スタンダード

- 標準低頻度アクセス

- 1 ゾーン低頻度アクセス

- 低冗長化ストレージ

- Amazon S3 Glacier

- Intelligent-Tiering

<br>

## 5. S3 のデータ転送効率化を実現する機能

- **マルチパートアップロード**

  大容量のオブジェクトを「_パート_」と呼ばれる複数の単位に分割してアップロードすることで、S3 への転送を効率よく行う。

  **Amazon Transfer Acceleration**という機能を有効化し、クライアントと S3 間の通信を高速化できる。

<br>

## 6. ストレージ以外での用途

- Web サイトホスティング

  静的コンテンツの Web サイトホスティングの機能も備えている。

  Route53 の DNS フェイルオーバー機能と組み合わせることで、Web サイトの Sorry ページとしても利用される。

- データストア

- 署名付き URL

  AWS CLI や AWS SDK を利用して、署名付き URL を発行できる。

  S3 上のデータに対して一定時間だけアクセスを許可するための URL を発行する機能。

---

## ■ Amazon Elastic Block Storage(EBS)

EC2 インスタンスにアタッチすることで利用できる。

**AZ 内で自動複製される EBS 　 vs 　 AZ 間で自動複製される S3**

<br>

## 1. ボリュームタイプ

- 汎用 SSD

- プロビジョンド IOPS SSD

- スループット最適化 HDD

- コールド HDD

- マグネティック

<br>

## 2. スナップショットによるバックアップ

スナップショットは自動的に S3 へ保管される。初回はフルバックアップを行うが、以降は増分で取得する。

---

## ■ Amazon Elastic File System(EFS)

複数の EC2 インスタンスから共有ファイルストレージとして利用可能。

<br>

## 1. 高可用性

複数の AZ に冗長化してデータを保管する。AZ をまたいでファイルアクセスできる。

<br>

## 2. 自動スケーリング

マネージド型サービスで、ストレージ容量やパフォーマンスを自動的にスケーリングする機能を持つ。

<br>

## 3. 標準的なファイルシステム

NFS(**Network File System**)によってアクセスする。オンプレミスサーバーからも利用できる。

---

## ■ Amazon FSx

コスト効率のよいファイルシステムを提供するサービス。

<br>

## 1. 高可用性と高耐久性

マルチ AZ 対応のため、高い可用性を持つ。また S3 へのバックアップも可能。

<br>

## 2. 高速で柔軟なパフォーマンス

データ保管用ストレージは HDD や SSD に対応しており、システム要件に応じて最適なパフォーマンスを選択可能。

<br>

## 3. セキュリティ保護

FSx に保管されたデータや通信中のデータはすべて暗号化される。

IAM ポリシーによる API コールのアクセス制御や、セキュリティグループを使ったアクセス制御も可能。

<br>

## 4. FSx のファイルシステム

- FSx for Windows

  SMB(Server Message Block)を使用して、データへのアクセスが可能なファイルシステム。

  AD との連携や Windows の ACL でのアクセス制御が可能。

- FSx for Lustre

  機械学習や HPC など処理速度を重視するシステムに利用される Linux ベースのファイルシステム。

---

## ■ その他

## 1. インスタンスストア(エフェメラルディスク)

ホストコンピュータのローカル領域を使うため、高パフォーマンスだが、揮発性ディスク。

<br>

## 2. Amazon Storage Gateway(SGW)

S3 へ NFS, SMB, iSCSI といった標準プロトコルでアクセスできるサービス。

EC2 インスタンスにもオンプレミスサーバーにも S3 をマウントして利用可能。

- キャッシュ型ボリューム GW

  データは S3、アクセス頻度が高いデータはローカルにキャッシュする。I/F は iSCSI

- 保管型ボリューム GW

  データをスナップショットとして S3 に保管する。

- テープゲートウェイ

  物理テープ装置の代替としてデータを S3(Glacier)に保管。

- ファイルゲートウェイ

  データをオブジェクトとして直接 S3 に格納する。I/F は NFS。

<br>

## 3. AWS Import/Export

ユーザーから送付された物理ディスクのデータを AWS が AWS 内のストレージへ転送したり、ユーザーの物理ディスクに書き出したりするサービス。

通常の NW 転送では非常に時間のかかる大容量データ移行に有効。

<br>

## 4. AWS Snowball

AWS から物理搬送される耐久性の高い筐体に大容量のデータを保管し、AWS 内のストレージへ転送するサービス。

Snowball 内のデータは自動的に暗号化される。
