# コスト最適化 <!-- omit in toc -->

- [1. AWS サービスの購入オプション](#1-aws-サービスの購入オプション)
- [2. オンデマンドインスタンス(デフォルト)](#2-オンデマンドインスタンスデフォルト)
- [3. リザーブドインスタンス](#3-リザーブドインスタンス)
- [4. スケジュールされたリザーブドインスタンス](#4-スケジュールされたリザーブドインスタンス)
- [5. スポットインスタンス](#5-スポットインスタンス)
- [6. 適切なインスタンスタイプの選定](#6-適切なインスタンスタイプの選定)
  - [6.1. インスタンスファミリー](#61-インスタンスファミリー)
  - [6.2. インスタンス世代](#62-インスタンス世代)
  - [6.3. インスタンスサイズ](#63-インスタンスサイズ)

## 1. AWS サービスの購入オプション

| 購入オプション | 特徴                                   | 主サービス         |
| -------------- | -------------------------------------- | ------------------ |
| オンデマンド   | 初期費用なしで使用分の従量課金         | EC2, RDS, Redshift |
| リザーブド     | 長期利用券による購入割引がある         | EC2, RDS, Redshift |
| スポット       | AWS の余っているリソースを安く利用可能 | EC2, Amazon EMR    |

## 2. オンデマンドインスタンス(デフォルト)

あらかじめ決められた一定レートの料金で使用した時間に対して課金されるため、使用期間の制約はない。

## 3. リザーブドインスタンス

あらかじめ決められた使用期間分(1 年 or3 年)を購入することで最大 75％オフの購入割引が適用される。  
支払い方法は「全額前払い」「一部前払い」「前払い無し」の 3 種類で「全額前払い」では、途中で利用をキャンセルしても払い戻しはない。

- Standard タイプ  
  リージョンや AZ を指定してインスタンスを購入できる。  
  同じインスタンス構成であれば、購入時に指定したリージョン内、または AZ 内でインスタンスの配置変更が可能。それ以外では手続きが必要。

- Convertible タイプ  
  あらかじめ指定したインスタンス構成に依存せず、柔軟に構成変更が可能。  
  その分、Standard より割引率が低い。

## 4. スケジュールされたリザーブドインスタンス

「営業時間中のみ稼働する」「週末や月末のバッチ処理でのみ稼働する」といった  
ある特定期間に限定して稼働させたい場合に適した機能。

## 5. スポットインスタンス

最大で 90%オフとなる、最も割引率が高い購入オプション。

変動する EC2 インスタンスのスポット価格に対し、希望の価格で入札する。  
_スポット価格を上回っていればインスタンスが起動し利用できるが、スポット価格が高騰して入札価格を上回ると強制終了される_。  
スポットインスタンスは、処理が中断されても支障なく再実行が可能なシステムに適している。

- スポットブロック  
  継続期間を意味する。この設定がされたスポットインスタンスでは、  
  インスタンス起動後、設定された時間に対して継続して動作することを保証するオプションとなる(最大 6 時間)。

- スポットフリート  
  あらかじめ指定した性能キャパシティを満たすように、スポットインスタンスを構成するオプション。

---

## 6. 適切なインスタンスタイプの選定

### 6.1. インスタンスファミリー

EC2 などのコンピューティングリソースの利用用途や特性に合わせた、サイジングの種類

| インスタンスファミリー   | 主な種類       | 特徴                                        |
| ------------------------ | -------------- | ------------------------------------------- |
| 汎用                     | T2, T3, M4, M5 | 一般的なシステム用途に適用可能なバランス型  |
| コンピューティング最適化 | C4, C5         | コスト効果の高い CPU 処理に特化             |
| メモリ最適化             | X1e, X1, R5    | 大容量のメモリに特化                        |
| 高速コンピューティング   | P2, P3, G3, F1 | GPU や FPGA など高速処理に特化              |
| ストレージ最適化         | H1, I3, D2     | ストレージ容量や I/O スループット性能に特化 |

### 6.2. インスタンス世代

M4 や M5 などについている数字のこと。  
大きい数字ほど新しく、一般的には最新のアーキテクチャが採用されているため、高性能かつ安価なものが多い。

### 6.3. インスタンスサイズ

large や xlarge、2xlarge などインスタンスのサイズを示す単語が付与されている。
