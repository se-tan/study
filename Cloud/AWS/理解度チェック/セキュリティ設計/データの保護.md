## ■ 暗号化によるデータの保護
### - 通信の暗号化
**SSL/TSL**などの暗号化の仕組みをユーザーとAWSの間で導入できる。  
またAWSでは、SSL/TSL証明書の購入や登録・更新などの一元管理ができる**AWS Certificate Manager (ACM)**サービスを提供しており、ELBなどへの証明書設定が簡単に行える。

### - 保管するデータ自体の暗号化
EBSやS3などに保管されるユーザーデータが、第三者からアクセスされることを防ぐ。  
これは、*ファイル暗号化*などにより実現する。

***
## ■ データ暗号化の方式と場所
### - クライアントサイドでの暗号化(CSE: Client Side Encryption)
AWSにデータを送信・保存する前に、**ユーザーの環境**でデータを暗号化する。

- **S3**のケース  
  ファイルに暗号化やパスワード処理などを施してからアップロードを行う。  
  AWS SDKを利用することで、プログラムからS3のアップロード時にファイル暗号化も可能

- **EBS**のケース  
  OSが提供するファイルシステムの暗号化機能などを用いて、
  ユーザーがファイルシステム全体を暗号化してからデータを保管する。

### - サーバーサイドでの暗号化(SSE: Server Side Encryption)
AWS側がファイルの暗号化処理を行う。

- **S3**  
  バケットに**デフォルト暗号化オプション**を設定することで、S3バケット内に保存されるファイルが自動的に暗号化される。  
  AWS SDKやAWS CLIを利用することで、サーバーサイドのファイル暗号化の指定も可能。鍵は以下のいずれかを利用する。
  * ユーザーが管理している鍵
  * S3で自動生成された鍵
  * KMSなどのサービスと連携して生成された鍵

- **EBS**  
  ボリューム作成時に暗号化設定が可能。*既存のEBSボリューム*を暗号化ボリュームに変更するには以下の手順が必要
  * 既存のボリュームのスナップショットを作成
  * 作成したスナップショットを***複製する際に***暗号化オプションを指定
  * 暗号化されたスナップショットからEBSボリュームを再作成
  * EC2インスタンスから既存のEBSボリュームをデタッチ
  * EC2インスタンスへ暗号化されたEBSボリュームをアタッチ、

***
## ■ 暗号化に必要な鍵の管理
|管理|保管|暗号化処理|サービス|概要|
|----|----|----------|--------|----|
|ユーザー|ユーザー|CSE|無し|ユーザー自身の責任・環境において管理と保管を行う|
|ユーザー|AWS|CSE or SSE|KMS or CloudHSM|ユーザー自身が鍵の作成・管理を行うが、KMSやCloudHSMサービス上で保管|
|AWS|AWS|SSE|各AWSサービスの暗号化機能|鍵の管理・保管などが全てAWS側のサービス上で透過的に行なわれる|

***
## ■ AWS KMSとCloudHSMによる鍵の管理・保管
### - AWS Key Management Service (KMS)による鍵の管理・保管
AWS上で鍵管理を提供するマネージドサービスで、主に暗号化鍵(CMK)の作成や有効/無効の管理、ローテーション、削除などができる。  
鍵自体はAWS上に保存される。KMSと連携した暗号化処理が可能な主なAWSサービスは以下のようなものがある。
* AWS SDKやAWS CLIを利用したクライアントアプリケーション
* S3、EBS、RDS、RedshiftなどのストレージやDBサービス

### - AWS CloudHSMによる鍵の管理・保管
HSM(**Hardware Security Module**)は、AWSのDC内に配置されるユーザー占有のハードウェアアプライアンス。
>**アプライアンス**  
特定の機能に特化したコンピュータのこと。Webサーバーやメールサーバーなど  

AWSはHSMのアプライアンス自体を管理し、ユーザーは自身だけがそのアプライアンスに保存される鍵を管理することができる。

HSM自体がユーザーのVPC内に配置され、ほかのNWから隔離されることや、国際的なセキュリティ基準(NIST FIPS140-2など)に準拠していることなどから、  
セキュリティコンプライアンス要件が厳しい場合に適用する。

***
## ■ AWS Secrets Managerによる認証情報の管理・保管
RDSやRedshiftなどの**DBの認証情報**(ユーザーやパスワード)を暗号化して集中管理・保管するサービス。

通常、アプリケーションからDBにアクセスするためには、アプリケーション内にDBの認証情報を保持しておかなければならず、漏洩などによるセキュリティリスクがある。  
アプリケーションからSecrets Manager APIを実行することで、保管されているDBの認証情報をセキュアに取得できる。

また、DBの認証情報を自動的に更新できるという特徴もある。  
KMSと連携して、認証情報を暗号化する際に鍵の管理をKMSで行なうこともできる。

***
## ■ ■ S3におけるデータ暗号化
|暗号化方式|暗号化処理|鍵の管理|
|----------|----------|--------|
|CSE|クライアントサイド|クライアントが提供・管理|
|SSE-C|サーバーサイド|クライアントが提供・管理|
|SSE-S3|サーバーサイド|S3が提供・管理|
|SSE-KMS|サーバーサイド|KMSが提供・管理|