# 高性能アーキテクチャの設計
## Amazon API Gateway
グローバルおよびサービスコールごとを含む複数のレベルでのスロットリングを提供する。また完全に管理されたサービスの為、リソースへアクセスはできない。
>***スロットリング***  
一定時間内に受信可能な通数に制限を設ける。制限を上回る大量のメールを送信した場合、メールの受信は拒否され、バウンスを示すエラーコードが返す。

***
## Amazon MQ
規定のAppでメッセージングを使用していて、メッセージングサービスを迅速かつ簡単にクラウド移行したい場合に使用する。

アプリケーションのメッセージングコードを書き換えることなく、標準ベースのメッセージブローカーから切り替えることができる。

>全く新しいアプリケーションを構築する場合は***Amazon SQSとAmazon SNS***がよい

***
## DynamoDB
耐久性、拡張性、可用性に優れたデータストアで、**リアルタイム集計**に使用できる。

AppSyncと併用することで、共有データをリアルタイムに更新するコラボレーションアプリを簡単に構築することができる。
***
## Amazon RedShift
データウェアハウスとして、またオンライン分析処理に使用される。
***
## Amazon Athena
標準的なSQLを使用してAmazon S3のデータを簡単に分析することができるインタラクティブなクエリサービス。

サーバーレスであり、実行するクエリに対してのみ料金が発生する。
***
## DynamoDB Stream
Amazon DynamoDBテーブルのアイテムへの変更に関する情報の順序付きフロー。ストリームを有効にすると、DynamoDBはテーブル内のデータアイテムに対する全ての変更に関する情報を取得する。

Appがテーブル内のアイテムを作成、更新、削除するたびに、変更されたアイテムの主キー属性を持つストリームレコードを書き込む。

AWS Lambdaと統合されており、DynamoDB Streamのポーリングによって新規のストレージレコードを検知すると、Lambda関数を呼び出す。
***
## Elastic Load Balancing(ELB)
ロードバランサーに送信されたリクエストの詳細情報を記録するアクセスログを提供している。

- リクエストを受信した時間
- クライアントのIPアドレス
- レイテンシー、リクエストパス、サーバーのレスポンスなど

デフォルトでは無効。有効にすると、ログを取得後、指定のAmazon S3バケットに圧縮ファイルとして保存する。
***
## Elastic Block Service(EBS)
- SSDは**小規模なランダムI/O操作**に適している
- HDDは**大規模なシーケンシャルI/O操作**に適している  
    Amazon EMR, ETL, データウェアハウス, ログ処理に適している
***
## Amazon SQS
完全に管理されたメッセージキューイングサービス。マイクロサービス、分散システム、サーバーレスAppのデカップリングとスケールアップを容易にする。
***
## Amazon S3
バケットで特定のイベントが発生したときに通知を受け取ることができる。
1. 発行させたいイベントと、Amazon S3が通知を送信したい宛先を特定する通知構成を追加する
2. バージョニングを有効にする。  
   ※書き込みが成功するたびにイベント通知を指せるようにするため。
***
## EC2
### EC2のライフサイクル
- pending: 実行状態に入る準備をしている。初回起動や停止状態からの再起動時に保留状態になる。
- running:起動状態。
- stopping:シャットダウンされており、使用できない。再起動可能。
- shutting-down:終了の準備中。
- terminated:インスタンスは永久的に削除され、再起動できない。

**リザーブドインスタンスは、支払いオプションに応じて、期間終了まで課金される**

### SSH接続
EC2インスタンスのセキュリティグループでポート22が許可されていることを確認する。

インスタンス起動時に、1つまたは複数のセキュリティグループを関連付ける。

各セキュリティグループには、関連付けられたインスタンス間とのトラフィックを許可するルーツを追加する。

ルールはいつでも変更可能でステートフルな(情報を保持する)為、自動的に適用される。
***
## Route53
Route53のヘルスチェックを使用して、Active-ActiveおよびActive-Passiveのフェイルオーバー設定ができる。

- Active-Active Failover:フェイルオーバー以外の任意のルーティングポリシーを使用
- Active-passive Failover:フェイルオーバー・ルーティングポリシーを使用

この構成は、全てのリソースをほとんどの時間で利用可能にしたい場合に使用する。

###  Active-Active
同じ名前、同じタイプなど、同じルーティングポリシーを持つすべてのレコードは、  
Route53がそれらを不健全でないとみなさない限り、アクティブになる。

###  Acitive-Passive  
プライマリリソースまたはリソースのグループがほとんどの時間で利用可能であり、全てのプライマリリソースが利用できなくなった場合に備えて、  
セカンダリリソースまたはリソースのグループを待機させたい場合は、アクティブ-パッシブフェイルオーバー構成を使用する。
***
## NATゲートウェイ
### **AZ内では冗長化されるが、AZ間は冗長化されない**