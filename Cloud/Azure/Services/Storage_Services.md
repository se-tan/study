# Storage Services

- 構造化データ  
  RDBとも呼ばれ、データにフィールドやプロパティがあり、DBテーブルとして格納可能。  
  入力、クエリ分析を容易に行える半面、構造の厳密化が必要。

- 半構造化データ  
  リレーショナル形式でデータが格納されていないデータ構造。データの編成と階層を表すタグがある。  
  XMLやJSON形式がこれにあたる。非RDBやNoSQLとも呼ばれる。

- 非構造化データ  
  データの種類を制限しない、構造を持たないデータ。BLOBとして扱われ、VMのVHDファイル、画像/映像データ、PDFファイルなどが含まれる。

***

## ■ マネージドディスク

VMが利用するディスク装置は**マネージドディスク**サービスとして割り当てられる。種類は3つ。

- Premium SSD
  
- Standard SSD
  
- Standard HDD

課金は64GB単位で行なわれ、端数は切り上げられる。VM専用のため、他のサービスから使用することはない。

***

## ■ ストレージアカウント

アプリケーションから使う場合に利用するサービス。Standardの場合は使用分だけ課金される。最大500TB。

>マネージドディスクは契約容量で課金され、サイズの縮小ができないのでコスト最適化ができない。

<br>

### - **BLOBストレージ(コンテナストレージ)**

バイナリオブジェクトとして扱うデータ形式で、順次アクセスに最適な**ブロックBLOB**、ランダムアクセスに最適な**ページBLOB**、追加のみが可能な**追加BLOB**を保存できる。

ページBLOBはVM用のVHDとして利用することが多い(*非マネージドディスク*)。

<br>

### - **Fileストレージ**

階層構造が必要な場合や、専用アプリケーションを作成したくない場合に利用する。

SMB(Server Message Block)プロトコルを使用するため、Windows ServerにNWドライブとして追加可能。  
macOSやLinuxからは、SMBを指定してマウントすることで、外部ディスクとして利用可能。

<br>

### - **Tableストレージ**

半構造化データを扱うためにテーブル形式でデータを格納できる。

使用する場合は、アプリケーションプログラムを作成する必要がある。

<br>

### - **Queueストレージ**

アプリケーション間で非同期型の通信を実現するためのメッセージを格納するキューを作成できる。  
例えば異なる組織のサーバー間で通信する場合、相手が動作している保証がなくても、自動的に再送信が予約され、確実にデータが送信される。

アプリケーションプログラムを作成する必要がある。

<br>

### - **レプリケーションオプション**

- ローカル冗長 (**LRS**)  
  同じリージョンの同じDC内に3つのコピーを保持する。PremiumストレージではLRSのみ利用可能

- ゾーン冗長 (**ZRS**)  
  同じリージョン内の別々の可用性ゾーンに3つのコピーを作成する。Azureで可用性ゾーンを持つリージョンには、必ず3つ以上の可用性ゾーンがある。汎用v2が必要。

- 地理冗長 (**GRS**)  
  プライマリリージョン/セカンダリリージョンに3つのコピーを保持。  
  セカンダリリージョンにはプライマリのリージョンペアが使用される。

- 読み取りアクセス地理冗長 (**RA-GRS**)  
  保持するコピーはGRSと同じだが、セカンダリリージョンの保持するコピーされたデータに読み取り専用のアクセスが可能。

- 地理ゾーン冗長 (**GZRS**)  
  GRSのプライマリリージョンをZRSに変更したもの

- 読み取りアクセス地理ゾーン冗長 (**RA-ZGRS**)  
  RA-GRSのプライマリリージョンをZRSに変更したもの