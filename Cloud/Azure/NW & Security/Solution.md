# 適切なAzureセキュリティソリューションの選択

## ■ 多層防御 (Defense in Depth)

攻撃に対して階層的に防御を行なうことで、機密情報への被害を最小にするというアプローチ。

NWの安全性を確保するとき、「安全な内部」と「危険な外部」の2つにわけ、その境界を1箇所で厳重に防御する方法もある(*単一境界防御*)が、突破された場合は致命的になりやすい。

Microsoftでは多層防御において、以下の7層に区分している。

### - **データ層**

脅威としてはデータの漏洩や改ざん、破壊が含まれる。具体的には、社員や顧客の個人情報流出、社外秘の業務データの流出、Webサイトの改ざんなど。

データ層の脆弱性は、システム構成に由来するものと、運用に由来するものがある。  

- システム構成：
  サーバー層やネットワーク層に根本原因があるため、データ層では考慮しない。

- 運用由来：
  「適切なセキュリティ設定を怠った」「誤って管理者アカウントのパスワードを公開した」など

<br>

### - **アプリケーション層**

脅威としては、アプリケーションが扱うデータの不正な取得、実行ファイルの不正な変更、アプリケーションを介したサーバーへの不正アクセスなど。

アプリケーション層の脆弱性は、入力データに対して適切な検査が行われていないことや、アプリケーションが利用するミドルウェアの脆弱性が主な原因となる。  
例として、異常に長い文字列を送り付けてシステムを停止させたり、インジェクションなど。

この脆弱性は、基本的には利用者の責任だが、PaaSの場合のミドルウェアやOSの保守派クラウドベンダーの責任となる。

<br>

### - **サーバー層 (ホスト層)**

マルウェアの侵入を含む不正なプログラムの実行が脅威として含まれる。

侵入経路の多くはOSの脆弱性を利用したもの。大抵はOSベンダーの修正プログラムを利用して、OSを最新の状態にしておけば防げる。

Azureの場合、VMとして動作するWindowsやLinuxの保守は利用者の責任となる。  
ただし、PaaSの場合などを除く。

<br>

### - **内部ネットワーク層**

不正な接続や機密データの盗聴などがあり、情報漏洩のリスクにつながる。

Azureの場合、内部ネットワークとはVNETであり、利用者が適切な設定をしている限り、そのリスクはMicrosoftの責任となる。

<br>

### - **境界ネットワーク層**

DDoS攻撃や、外部ネットワークからの不正アクセスが脅威としてある。  
この層の攻撃は、TCPポートとUDPポートに集中しており、特にTCPポート80番への攻撃が目立つ。

境界ネットワーク層はVNETとインターネットの接続点であり、その責任は原則Microsoftにある。  
ただし、Azure Firewallなどを使って境界ネットワークを利用者が管理している場合は、利用者に構成上の責任がある。

<br>

### - **物理セキュリティ層**

攻撃者が物理マシンなどのハードウェアに対して直接アクセスすることが脅威として含まれる。

<br>

### - **ポリシー、標準、手順、認識**

セキュリティモデルの全ての層を取り囲んでいる。

セキュリティに必要な操作は「手順」で決められているが、その手順は組織で決められた適切な「標準」を使用して、組織全体の「ポリシー」に基づいたものでなければならない。  
セキュリティに対する「認識」を、関連するすべての部署に浸透させることも重要。
